{% extends "base.html" %}

{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - Flask Auth App{% endblock %}

{% block card_class %}dashboard-card{% endblock %}

{% block content %}
    <div style="text-align: center; margin-bottom: 3rem;">
        <h2 style="color: #8b949e; font-size: 1rem; font-weight: 400; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.1em;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</h2>
        <div class="username-display">{{ user['username'] }}</div>
    </div>
    
    <div class="user-info">
        <h3 style="margin-bottom: 1.5rem; color: #58a6ff; font-size: 1.1rem; font-weight: 600;">üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
        <p><strong>ID:</strong> {{ user['id'] }}</p>
        <p><strong>Email:</strong> {{ user['email'] }}</p>
        <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user['created_at'] }}</p>
    </div>

    <div style="background: rgba(88, 166, 255, 0.05); border: 1px solid rgba(88, 166, 255, 0.2); padding: 2rem; border-radius: 12px; margin-bottom: 2rem;">
        <h3 style="color: #f0f6fc; margin-bottom: 1rem; font-weight: 600;">üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>
        <p style="color: #8b949e; line-height: 1.6;">
            –í—ã —É—Å–ø–µ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å –≤ —Å–∏—Å—Ç–µ–º–µ. –≠—Ç–æ –∑–∞—â–∏—â–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –¥–æ—Å—Ç—É–ø–Ω–∞—è —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
        </p>
    </div>

    <div style="background: rgba(188, 140, 255, 0.05); border: 1px solid rgba(188, 140, 255, 0.2); padding: 2rem; border-radius: 12px; margin-bottom: 2rem; text-align: center;">
        <h3 style="color: #f0f6fc; margin-bottom: 1rem; font-weight: 600;">ü§ñ AI –ß–∞—Ç</h3>
        <p style="color: #8b949e; line-height: 1.6; margin-bottom: 1.5rem;">
            –û–±—â–∞–π—Ç–µ—Å—å —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ Gemini. –ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã, –ø–æ–ª—É—á–∞–π—Ç–µ –ø–æ–º–æ—â—å –∏ –∏—Å—Å–ª–µ–¥—É–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞.
        </p>
        <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <a href="{{ url_for('chat') }}" style="display: inline-block;">
                <button class="btn" style="background: linear-gradient(135deg, #58a6ff 0%, #bc8cff 100%); min-width: 200px;">
                    –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç ‚Üí
                </button>
            </a>
            <button id="testApiBtn" class="btn" style="background: #30363d; border: 1px solid #484f58; min-width: 200px;">
                –¢–µ—Å—Ç API
            </button>
        </div>
        <div id="apiTestResult" style="margin-top: 1rem; display: none;"></div>
    </div>
    
    <script>
        document.getElementById('testApiBtn')?.addEventListener('click', async function() {
            const btn = this;
            const resultDiv = document.getElementById('apiTestResult');
            const originalText = btn.innerHTML;
            
            btn.disabled = true;
            btn.innerHTML = '–¢–µ—Å—Ç–∏—Ä—É—é...';
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="color: #8b949e;">–ü—Ä–æ–≤–µ—Ä—è—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Gemini API...</div>';
            
            try {
                const response = await fetch('/api/test-gemini');
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div style="background: rgba(46, 160, 67, 0.1); border: 1px solid rgba(46, 160, 67, 0.3); padding: 1rem; border-radius: 8px; color: #3fb950;">
                            <strong>‚úì API —Ä–∞–±–æ—Ç–∞–µ—Ç!</strong><br>
                            <small style="color: #8b949e;">–û—Ç–≤–µ—Ç: ${data.response}</small>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: rgba(248, 81, 73, 0.1); border: 1px solid rgba(248, 81, 73, 0.3); padding: 1rem; border-radius: 8px; color: #f85149;">
                            <strong>‚úó –û—à–∏–±–∫–∞:</strong> ${data.error}<br>
                            ${data.details ? `<small style="color: #8b949e;">${data.details}</small>` : ''}
                            <br><br>
                            <small style="color: #8b949e;">
                                –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:<br>
                                1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞: <code>pip install google-generativeai</code><br>
                                2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –≤ app.py<br>
                                3. –ê–∫—Ç–∏–≤–µ–Ω –ª–∏ –∫–ª—é—á –≤ <a href="https://ai.google.dev/" target="_blank" style="color: #58a6ff;">Google AI Studio</a>
                            </small>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: rgba(248, 81, 73, 0.1); border: 1px solid rgba(248, 81, 73, 0.3); padding: 1rem; border-radius: 8px; color: #f85149;">
                        <strong>‚úó –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</strong> ${error.message}
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = originalText;
            }
        });
    </script>

    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="{{ url_for('index') }}" style="flex: 1; min-width: 150px;">
            <button class="btn btn-secondary">
                –ù–∞ –≥–ª–∞–≤–Ω—É—é
            </button>
        </a>
        <a href="{{ url_for('logout') }}" style="flex: 1; min-width: 150px;">
            <button class="btn" style="background: #da3633;">
                –í—ã–π—Ç–∏
            </button>
        </a>
    </div>
{% endblock %}
